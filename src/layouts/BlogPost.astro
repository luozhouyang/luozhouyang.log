---
import type { CollectionEntry } from "astro:content";
import BaseHead from "../components/BaseHead.astro";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import FormattedDate from "../components/FormattedDate.astro";
import Badge from "../components/ui/Badge.astro";

type Props = CollectionEntry<"blog">["data"];

const { title, description, pubDate, updatedDate, tags = [] } = Astro.props;
---

<html lang="en" class="light">
  <head>
    <BaseHead title={title} description={description} />
    <script is:inline>
      // 在页面加载前检查主题设置
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark' || (!savedTheme && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
        document.documentElement.classList.add('dark');
        document.documentElement.classList.remove('light');
      } else {
        document.documentElement.classList.add('light');
        document.documentElement.classList.remove('dark');
      }
    </script>
  </head>

  <body class="min-h-screen bg-background font-sans antialiased">
    <Header />
    <main class="container py-10">
      <article class="mx-auto max-w-3xl">
        <div class="prose prose-base dark:prose-invert max-w-none dark:text-opacity-100 dark:text-white">
          <div class="mb-8 text-center">
            <div class="text-muted-foreground mb-2 dark:text-white/90">
              <FormattedDate date={pubDate} />
              {
                updatedDate && (
                  <div class="italic mt-1">
                    Last updated on <FormattedDate date={updatedDate} />
                  </div>
                )
              }
            </div>
            <h1 class="text-4xl font-bold tracking-tight sm:text-5xl mb-4">
              {title}
            </h1>
            {
              tags.length > 0 && (
                <div class="flex flex-wrap justify-center gap-2 mb-6">
                  {tags.map((tag) => (
                    <Badge variant="secondary" asChild>
                      <a href="/">{tag}</a>
                    </Badge>
                  ))}
                </div>
              )
            }
            <hr class="my-6 border-t border-border" />
          </div>
          <slot />
        </div>
      </article>
    </main>
    <Footer />
  </body>
</html>
